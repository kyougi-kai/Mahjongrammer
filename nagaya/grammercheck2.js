let tango = {
    apple: {
        //名詞
        hinsi: ['名詞'],
        tags: ['可算名詞','単数型'],
        katuyou: ['apples'],
    },
    apples: {
        hinsi: ['名詞'],
        tags: ['可算名詞','複数型'],
        katuyou: ['apples'],
    },
    desk: {
        hinsi: ['名詞'],
        tags: ['可算名詞','単数型'],
        katuyou: ['desks'],
    },
    desks: {
        hinsi: ['名詞'],
        tags: ['可算名詞','複数型'],
        katuyou: ['desk'],
    },
    cat: {
        hinsi: ['名詞'],
        tags: ['可算名詞','単数型'],
        katuyou: ['cats'],
    },
    cats: {
        hinsi: ['名詞'],
        tags: ['可算名詞','複数型'],
        katuyou: ['cat'],
    },
    book: {
        hinsi: ['名詞'],
        tags: ['可算名詞','単数型'],
        katuyou: ['books'],
    },
    books: {
        hinsi: ['名詞'],
        tags: ['可算名詞','複数型'],
        katuyou: ['book'],
    },
    water: {
        hinsi: ['名詞'],
        tags: ['不可算名詞'],
    },
    happiness: {
        hinsi: ['名詞'],
        tags: ['不可算名詞'],
    },
    money: {
        hinsi: ['名詞'],
        tags: ['不可算名詞'],
    },
    information: {
        hinsi: ['名詞'],
        tags: ['不可算名詞'],
    },
    Tokyo: {
        hinsi: ['名詞'],
        tags: ['不可算名詞'],
    },
    Einstein: {
        hinsi: ['名詞'],
        tags: ['不可算名詞'],
    },
    Amazon: {
        hinsi: ['名詞'],
        tags: ['不可算名詞'],
    },
    iPhone: {
        hinsi: ['名詞'],
        tags: ['不可算名詞'],
    },
    I: {
        //代名詞
        hinsi: ['代名詞'],
        tags: ['一人称', '単数', '人称代名詞', '主格'],
    },
    me: {
        hinsi: ['代名詞'],
        tags: ['一人称', '単数', '人称代名詞', '目的格'],
    },
    my: {
        hinsi: ['代名詞'],
        tags: ['一人称', '単数', '人称代名詞', '所有格'],
    },
    mine: {
        hinsi: ['代名詞'],
        tags: ['一人称', '単数', '人称代名詞', '所有代名詞'],
    },
    you: {
        hinsi: ['代名詞'],
        tags: ['二人称', '単数/複数', '人称代名詞', '主格/目的格'],
    },
    your: {
        hinsi: ['代名詞'],
        tags: ['二人称', '単数/複数', '人称代名詞', '所有格'],
    },
    yours: {
        hinsi: ['代名詞'],
        tags: ['二人称', '単数/複数', '人称代名詞', '所有代名詞'],
    },
    he: {
        hinsi: ['代名詞'],
        tags: ['三人称', '単数', '人称代名詞', '主格', '男性'],
    },
    him: {
        hinsi: ['代名詞'],
        tags: ['三人称', '単数', '人称代名詞', '目的格', '男性'],
    },
    his: {
        hinsi: ['代名詞'],
        tags: ['三人称', '単数', '人称代名詞', '所有格', '男性'],
    },
    she: {
        hinsi: ['代名詞'],
        tags: ['三人称', '単数', '人称代名詞', '主格', '女性'],
    },
    her: {
        hinsi: ['代名詞'],
        tags: ['三人称', '単数', '人称代名詞', '目的格/所有格', '女性'],
    },
    hers: {
        hinsi: ['代名詞'],
        tags: ['三人称', '単数', '人称代名詞', '所有代名詞', '女性'],
    },
    it: {
        hinsi: ['代名詞'],
        tags: ['三人称', '単数', '人称代名詞', '主格/目的格', '中性'],
    },
    its: {
        hinsi: ['代名詞'],
        tags: ['三人称', '単数', '人称代名詞', '所有格', '中性'],
    },
    we: {
        hinsi: ['代名詞'],
        tags: ['一人称', '複数', '人称代名詞', '主格'],
    },
    us: {
        hinsi: ['代名詞'],
        tags: ['一人称', '複数', '人称代名詞', '目的格'],
    },
    our: {
        hinsi: ['代名詞'],
        tags: ['一人称', '複数', '人称代名詞', '所有格'],
    },
    ours: {
        hinsi: ['代名詞'],
        tags: ['一人称', '複数', '人称代名詞', '所有代名詞'],
    },
    they: {
        hinsi: ['代名詞'],
        tags: ['三人称', '複数', '人称代名詞', '主格'],
    },
    them: {
        hinsi: ['代名詞'],
        tags: ['三人称', '複数', '人称代名詞', '目的格'],
    },
    their: {
        hinsi: ['代名詞'],
        tags: ['三人称', '複数', '人称代名詞', '所有格'],
    },
    theirs: {
        hinsi: ['代名詞'],
        tags: ['三人称', '複数', '人称代名詞', '所有代名詞'],
    },
    this: {
        hinsi: ['代名詞'],
        tags: ['指示代名詞', '単数'],
    },
    that: {
        hinsi: ['代名詞'],
        tags: ['指示代名詞', '単数'],
    },
    these: {
        hinsi: ['代名詞'],
        tags: ['指示代名詞', '複数'],
    },
    those: {
        hinsi: ['代名詞'],
        tags: ['指示代名詞', '複数'],
    },
    myself: {
        hinsi: ['代名詞'],
        tags: ['再帰代名詞', '一人称', '単数'],
    },
    yourself: {
        hinsi: ['代名詞'],
        tags: ['再帰代名詞', '二人称', '単数'],
    },
    himself: {
        hinsi: ['代名詞'],
        tags: ['再帰代名詞', '三人称', '単数', '男性'],
    },
    herself: {
        hinsi: ['代名詞'],
        tags: ['再帰代名詞', '三人称', '単数', '女性'],
    },
    itself: {
        hinsi: ['代名詞'],
        tags: ['再帰代名詞', '三人称', '単数', '中性'],
    },
    ourselves: {
        hinsi: ['代名詞'],
        tags: ['再帰代名詞', '一人称', '複数'],
    },
    yourselves: {
        hinsi: ['代名詞'],
        tags: ['再帰代名詞', '二人称', '複数'],
    },
    themselves: {
        hinsi: ['代名詞'],
        tags: ['再帰代名詞', '三人称', '複数'],
    },
    who: {
        hinsi: ['代名詞'],
        tags: ['疑問代名詞'],
    },
    whose: {
        hinsi: ['代名詞'],
        tags: ['疑問代名詞', '所有格'],
    },
    what: {
        hinsi: ['代名詞'],
        tags: ['疑問代名詞'],
    },
    which: {
        hinsi: ['代名詞'],
        tags: ['疑問代名詞'],
    },
    someone: {
        hinsi: ['代名詞'],
        tags: ['不定代名詞', '単数', '肯定'],
    },
    anyone: {
        hinsi: ['代名詞'],
        tags: ['不定代名詞', '単数', '否定'],
    },
    everyone: {
        hinsi: ['代名詞'],
        tags: ['不定代名詞', '単数'],
    },
    something: {
        hinsi: ['代名詞'],
        tags: ['不定代名詞', '単数', '肯定'],
    },
    anything: {
        hinsi: ['代名詞'],
        tags: ['不定代名詞', '単数', '否定'],
    },
    nothing: {
        hinsi: ['代名詞'],
        tags: ['不定代名詞', '単数'],
    },
    all: {
        hinsi: ['代名詞'],
        tags: ['不定代名詞', '単数', '複数'],
    },
    eat: {
        //動詞
        hinsi: ['動詞'],
        tags: ['他動詞', '動作動詞'],
        katuyou: ['eat', 'eats', 'ate', 'eaten', 'eating'],
    },
    run: {
        hinsi: ['動詞'],
        tags: ['自動詞', '動作動詞'],
        katuyou: ['run', 'runs', 'ran', 'run', 'running'],
    },
    sleep: {
        hinsi: ['動詞'],
        tags: ['自動詞', '動作動詞'],
        katuyou: ['sleep', 'sleeps', 'slept', 'slept', 'sleeping'],
    },
    read: {
        hinsi: ['動詞'],
        tags: ['他動詞', '動作動詞'],
        katuyou: ['read', 'reads', 'read', 'read', 'reading'],
    },
    write: {
        hinsi: ['動詞'],
        tags: ['他動詞', '動作動詞'],
        katuyou: ['write', 'writes', 'wrote', 'written', 'writing'],
    },
    know: {
        hinsi: ['動詞'],
        tags: ['他動詞', '状態動詞'],
        katuyou: ['know', 'knows', 'knew', 'known', 'knowing'],
    },
    love: {
        hinsi: ['動詞'],
        tags: ['他動詞', '状態動詞'],
        katuyou: ['love', 'loves', 'loved', 'loved', 'loving'],
    },
    see: {
        hinsi: ['動詞'],
        tags: ['他動詞', '知覚動詞'],
        katuyou: ['see', 'sees', 'saw', 'seen', 'seeing'],
    },
    hear: {
        hinsi: ['動詞'],
        tags: ['他動詞', '知覚動詞'],
        katuyou: ['hear', 'hears', 'heard', 'heard', 'hearing'],
    },
    become: {
        hinsi: ['動詞'],
        tags: ['連結動詞'],
        katuyou: ['become', 'becomes', 'became', 'become', 'becoming'],
    },
    make: {
        hinsi: ['動詞'],
        tags: ['他動詞', '使役動詞', 'SVOCがとれる動詞'],
        katuyou: ['make', 'makes', 'made', 'made', 'making'],
    },
    give: {
        hinsi: ['動詞'],
        tags: ['他動詞', 'SVOOがとれる動詞'],
        katuyou: ['give', 'gives', 'gave', 'given', 'giving'],
    },
    take: {
        hinsi: ['動詞'],
        tags: ['他動詞'],
        katuyou: ['take', 'takes', 'took', 'taken', 'taking'],
    },
    go: {
        hinsi: ['動詞'],
        tags: ['自動詞', '動作動詞'],
        katuyou: ['go', 'goes', 'went', 'gone', 'going'],
    },
    swim: {
        hinsi: ['動詞'],
        tags: ['自動詞', '動作動詞'],
        katuyou: ['swim', 'swims', 'swam', 'swum', 'swimming'],
    },
    be: {
        hinsi: ['動詞', '助動詞'],
        tags: ['連結動詞', 'be動詞', '相助動詞'],
        katuyou: ['be', '', '', 'been', 'being'],
    },
    am: {
        hinsi: ['動詞'],
        tags: ['連結動詞', 'be動詞'],
        katuyou: ['be', 'am', 'was', 'been', 'being'],
    },
    are: {
        hinsi: ['動詞'],
        tags: ['連結動詞', 'be動詞'],
        katuyou: ['be', 'are', 'were', 'been', 'being'],
    },
    is: {
        hinsi: ['動詞'],
        tags: ['連結動詞', 'be動詞'],
        katuyou: ['be', 'is', 'was', 'been', 'being'],
    },
    happy: {
        //形容詞
        hinsi: ['形容詞'],
        tags: ['限定用法', '叙述用法', '意見'],
        katuyou: ['happy', 'happier', 'happiest'],
    },
    blue: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '叙述用法', '色'],
        katuyou: ['blue', 'bluer', 'bluest'],
    },
    large: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '叙述用法', 'サイズ'],
        katuyou: ['large', 'larger', 'largest'],
    },
    wooden: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '素材'],
        katuyou: ['wooden', 'more wooden', 'most wooden'],
    },
    old: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '叙述用法', '年齢'],
        katuyou: ['old', 'older', 'oldest'],
    },
    beautiful: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '叙述用法', '意見'],
        katuyou: ['beautiful', 'more beautiful', 'most beautiful'],
    },
    round: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '叙述用法', '形'],
        katuyou: ['round', 'rounder', 'roundest'],
    },
    French: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '叙述用法', '起源'],
        katuyou: ['French', 'more French', 'most French'],
    },
    sleeping: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '目的'],
        katuyou: ['sleeping', 'more sleeping', 'most sleeping'],
    },
    three: {
        hinsi: ['形容詞'],
        tags: ['数詞'],
        katuyou: ['three', '', ''],
    },
    many: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '数量'],
        katuyou: ['many', 'more', 'most'],
    },
    hot: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '叙述用法', '温度'],
        katuyou: ['hot', 'hotter', 'hottest'],
    },
    some: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '数量'],
        katuyou: ['some', '', ''],
    },
    interesting: {
        hinsi: ['形容詞'],
        tags: ['限定用法', '叙述用法', '意見'],
        katuyou: ['interesting', 'more interesting', 'most interesting'],
    },
    tired: {
        hinsi: ['形容詞'],
        tags: ['叙述用法', '状態'],
        katuyou: ['tired', 'more tired', 'most tired'],
    },
    quickly: {
        //副詞
        hinsi: ['副詞'],
        tags: ['様態'],
    },
    carefully: {
        hinsi: ['副詞'],
        tags: ['様態'],
    },
    loudly: {
        hinsi: ['副詞'],
        tags: ['様態'],
    },
    slowly: {
        hinsi: ['副詞'],
        tags: ['様態'],
    },
    happily: {
        hinsi: ['副詞'],
        tags: ['様態'],
    },
    sadly: {
        hinsi: ['副詞'],
        tags: ['様態'],
    },
    easily: {
        hinsi: ['副詞'],
        tags: ['様態'],
    },
    well: {
        hinsi: ['副詞'],
        tags: ['様態'],
    },
    now: {
        hinsi: ['副詞'],
        tags: ['時間'],
    },
    yesterday: {
        hinsi: ['副詞'],
        tags: ['時間'],
    },
    soon: {
        hinsi: ['副詞'],
        tags: ['時間'],
    },
    later: {
        hinsi: ['副詞'],
        tags: ['時間'],
    },
    today: {
        hinsi: ['副詞'],
        tags: ['時間'],
    },
    tomorrow: {
        hinsi: ['副詞'],
        tags: ['時間'],
    },
    recently: {
        hinsi: ['副詞'],
        tags: ['時間'],
    },
    already: {
        hinsi: ['副詞'],
        tags: ['時間'],
    },
    here: {
        hinsi: ['副詞'],
        tags: ['場所'],
    },
    there: {
        hinsi: ['副詞'],
        tags: ['場所'],
    },
    everywhere: {
        hinsi: ['副詞'],
        tags: ['場所'],
    },
    outside: {
        hinsi: ['副詞'],
        tags: ['場所'],
    },
    inside: {
        hinsi: ['副詞'],
        tags: ['場所'],
    },
    upstairs: {
        hinsi: ['副詞'],
        tags: ['場所'],
    },
    nearby: {
        hinsi: ['副詞'],
        tags: ['場所'],
    },
    always: {
        hinsi: ['副詞'],
        tags: ['頻度'],
    },
    often: {
        hinsi: ['副詞'],
        tags: ['頻度'],
    },
    sometimes: {
        hinsi: ['副詞'],
        tags: ['頻度'],
    },
    rarely: {
        hinsi: ['副詞'],
        tags: ['頻度'],
    },
    never: {
        hinsi: ['副詞'],
        tags: ['頻度'],
    },
    usually: {
        hinsi: ['副詞'],
        tags: ['頻度'],
    },
    occasionally: {
        hinsi: ['副詞'],
        tags: ['頻度'],
    },
    very: {
        hinsi: ['副詞'],
        tags: ['程度'],
    },
    almost: {
        hinsi: ['副詞'],
        tags: ['程度'],
    },
    completely: {
        hinsi: ['副詞'],
        tags: ['程度'],
    },
    quite: {
        hinsi: ['副詞'],
        tags: ['程度'],
    },
    extremely: {
        hinsi: ['副詞'],
        tags: ['程度'],
    },
    hardly: {
        hinsi: ['副詞'],
        tags: ['程度'],
    },
    totally: {
        hinsi: ['副詞'],
        tags: ['程度'],
    },
    fortunately: {
        hinsi: ['副詞'],
        tags: ['文修飾'],
    },
    unfortunately: {
        hinsi: ['副詞'],
        tags: ['文修飾'],
    },
    surprisingly: {
        hinsi: ['副詞'],
        tags: ['文修飾'],
    },
    obviously: {
        hinsi: ['副詞'],
        tags: ['文修飾'],
    },
    honestly: {
        hinsi: ['副詞'],
        tags: ['文修飾'],
    },
    do: {
        //助動詞
        hinsi: ['助動詞'],
        tags: ['相助動詞'],
    },
    have: {
        hinsi: ['助動詞', '動詞'],
        tags: ['相助動詞', '他動詞', '動作動詞', '使役動詞'],
    },
    can: {
        hinsi: ['助動詞'],
        tags: ['法助動詞'],
    },
    will: {
        hinsi: ['助動詞'],
        tags: ['法助動詞'],
    },
    shall: {
        hinsi: ['助動詞'],
        tags: ['法助動詞'],
    },
    may: {
        hinsi: ['助動詞'],
        tags: ['法助動詞'],
    },
    must: {
        hinsi: ['助動詞'],
        tags: ['法助動詞'],
    },
    could: {
        hinsi: ['助動詞'],
        tags: ['法助動詞'],
    },
    would: {
        hinsi: ['助動詞'],
        tags: ['法助動詞'],
    },
    should: {
        hinsi: ['助動詞'],
        tags: ['法助動詞'],
    },
    might: {
        hinsi: ['助動詞'],
        tags: ['法助動詞'],
    },
    at: {
        //前置詞
        hinsi: ['前置詞'],
        tags: ['時間', '場所'],
    },
    on: {
        hinsi: ['前置詞'],
        tags: ['時間', '場所'],
    },
    in: {
        hinsi: ['前置詞'],
        tags: ['時間', '場所'],
    },
    by: {
        hinsi: ['前置詞'],
        tags: ['時間', '手段'],
    },
    during: {
        hinsi: ['前置詞'],
        tags: ['時間'],
    },
    before: {
        hinsi: ['前置詞'],
        tags: ['時間'],
    },
    after: {
        hinsi: ['前置詞'],
        tags: ['時間'],
    },
    until: {
        hinsi: ['前置詞'],
        tags: ['時間'],
    },
    since: {
        hinsi: ['前置詞'],
        tags: ['時間'],
    },
    for: {
        hinsi: ['前置詞'],
        tags: ['時間'],
    },
    under: {
        hinsi: ['前置詞'],
        tags: ['場所'],
    },
    above: {
        hinsi: ['前置詞'],
        tags: ['場所'],
    },
    below: {
        hinsi: ['前置詞'],
        tags: ['場所'],
    },
    between: {
        hinsi: ['前置詞'],
        tags: ['場所'],
    },
    beside: {
        hinsi: ['前置詞'],
        tags: ['場所'],
    },
    near: {
        hinsi: ['前置詞'],
        tags: ['場所'],
    },
    inside: {
        hinsi: ['前置詞'],
        tags: ['場所'],
    },
    to: {
        hinsi: ['前置詞'],
        tags: ['方向'],
    },
    into: {
        hinsi: ['前置詞'],
        tags: ['方向'],
    },
    towards: {
        hinsi: ['前置詞'],
        tags: ['方向'],
    },
    through: {
        hinsi: ['前置詞'],
        tags: ['方向'],
    },
    across: {
        hinsi: ['前置詞'],
        tags: ['方向'],
    },
    along: {
        hinsi: ['前置詞'],
        tags: ['方向'],
    },
    around: {
        hinsi: ['前置詞'],
        tags: ['方向'],
    },
    onto: {
        hinsi: ['前置詞'],
        tags: ['方向'],
    },
    off: {
        hinsi: ['前置詞'],
        tags: ['方向'],
    },
    with: {
        hinsi: ['前置詞'],
        tags: ['手段'],
    },
    using: {
        hinsi: ['前置詞'],
        tags: ['手段'],
    },
    via: {
        hinsi: ['前置詞'],
        tags: ['手段'],
    },
    through: {
        hinsi: ['前置詞'],
        tags: ['手段'],
    },
    without: {
        hinsi: ['前置詞'],
        tags: ['手段'],
    },
    a: {
        //冠詞
        hinsi: ['冠詞'],
        tags: ['不定冠詞'],
    },
    an: {
        hinsi: ['冠詞'],
        tags: ['不定冠詞'],
    },
    the: {
        hinsi: ['冠詞'],
        tags: ['定冠詞'],
    },
    and: {
        //接続詞
        hinsi: ['接続詞'],
        tags: ['等位接続詞'],
    },
    but: {
        hinsi: ['接続詞'],
        tags: ['等位接続詞'],
    },
    or: {
        hinsi: ['接続詞'],
        tags: ['等位接続詞'],
    },
    so: {
        hinsi: ['接続詞'],
        tags: ['等位接続詞'],
    },
    yet: {
        hinsi: ['接続詞'],
        tags: ['等位接続詞'],
    },
    for: {
        hinsi: ['接続詞'],
        tags: ['等位接続詞'],
    },
    because: {
        hinsi: ['接続詞'],
        tags: ['従位接続詞'],
    },
    although: {
        hinsi: ['接続詞'],
        tags: ['従位接続詞'],
    },
    if: {
        hinsi: ['接続詞'],
        tags: ['従位接続詞'],
    },
    when: {
        hinsi: ['接続詞'],
        tags: ['従位接続詞'],
    },
    while: {
        hinsi: ['接続詞'],
        tags: ['従位接続詞'],
    },
    since: {
        hinsi: ['接続詞'],
        tags: ['従位接続詞'],
    },
    until: {
        hinsi: ['接続詞'],
        tags: ['従位接続詞'],
    },
    unless: {
        hinsi: ['接続詞'],
        tags: ['従位接続詞'],
    },
    though: {
        hinsi: ['接続詞'],
        tags: ['従位接続詞'],
    },
};

const DaimeisicanSArray = ['主格', '指示代名詞', '不定代名詞', '疑問代名詞'];
const DaimeisicanCArray = ['主格', '所有代名詞', '再帰代名詞', '指示代名詞', '不定代名詞', '疑問代名詞'];
const DaimeisicanOArray = ['目的格', '再帰代名詞', '指示代名詞', '不定代名詞', '疑問代名詞'];

let checkGrammerTestArray = {
    sentence: 1,
    s: ['my'],
    v: ['run'],
};

const errorTemplete = {
    part: "",
    index: 0,
    type: "",
    reason: "",
    suggestion: ""
};

const testGCR = {
    success:false,
    successes:{S:[],V:[]},
    currentType:["S","V"],
    currentTypeNum:0,
    currentIndex:0,
    flagsNum:100,
    temporaryWordsNum:0,
    message:"",
    errors:{},
}

function checkGrammer(targetArray) {
    targetArray.sentence = targetArray.sentence.toString();

    /**
     * @typedef {Object} gcr
     * @property {boolean} success -成功-
     */

    /** @type {gcr} 文法チェックの結果を代入（旧grammerCheckResult）*/
    let GCR = {
        success:false,
        successes,
        currentType:[],
        currentTypeNum:0,
        currentIndex:0,
        flagsNum:100,
        temporaryWordsNum:0,
        message:"",
        errors,
    };

    switch (targetArray.sentence) {
        case '1': //第一文型SV
            GCR.successes.push({S:[],V:[]});
            GCR.currentType.push("S","V");
            checkS(targetArray.s,GCR);
            GCR.currentTypeNum++;
            checkV(targetArray.v,GCR,targetArray.sentence);
            GCR.currentTypeNum++;
            if(GCR.successes.S.includes("true") &&
                GCR.successes.V.includes("true") ){
                    GCR.success = true;
                }
            break;
        case '2': //第二文型SVC
            checkS(targetArray.s,GCR);
            checkV(targetArray.v,GCR,targetArray.sentence);
            checkC(targetArray.c,GCR);
            break;
        case '3': //第三文型SVO
            checkS(targetArray.s,GCR);
            checkV(targetArray.v,GCR,targetArray.sentence);
            checkO(targetArray.o1,GCR);
            break;
        case '4': //第四文型SVOO
            checkS(targetArray.s,GCR);
            checkV(targetArray.v,GCR,targetArray.sentence);
            checkO(targetArray.o1,GCR);
            checkO(targetArray.o2,GCR);
            break;
        case '5': //第五文型SVOC
            checkS(targetArray.s,GCR);
            checkV(targetArray.v,GCR,targetArray.sentence);
            checkO(targetArray.o1,GCR);
            checkC(targetArray.c,GCR);
            break;
        default:
            GCR.message.push("存在しない文型を指定しています");
            break;
    }
    return GCR;
}

function checkS(targetSentence,GCR) /*＜S＞*/ {
    GCR = checkMeisiRoot(targetSentence,GCR);
    GCR = checkDaimeisi(targetSentence,GCR);

    return GCR;
}

console.log("checkS結果：",checkS(checkGrammerTestArray.s,testGCR).successes.S);

function checkV(targetSentence,GCR,sentenceType)/*＜V＞*/{

}

function checkMeisiRoot(targetSentence,GCR)/*＜名詞根＞*/{
    console.log(1,targetSentence,GCR);
    GCR[GCR.flagsNum] = {};
    GCR[GCR.flagsNum] = {kansi:[],zentiKeiyousi:[],meisi:[],koutiKeiyousi:[],wordsCount:0,targetIndex:0};
    console.log("フラットなGCR",targetSentence,GCR);
    let truenum = targetSentence.flat(Infinity).length;
    if (targetSentence.length > GCR[GCR.flagsNum].targetIndex)GCR = checkKansiRoot(targetSentence,GCR);
    console.log("checkKansiroot通過後GCR",targetSentence,GCR);
    if (targetSentence.length > GCR[GCR.flagsNum].targetIndex)GCR = checkZentiKeiyousiRoot(targetSentence,GCR);
    console.log("checkZentiKeiyousiroot通過後GCR",targetSentence,GCR);
    if (targetSentence.length > GCR[GCR.flagsNum].targetIndex)GCR = checkMeisi(targetSentence,GCR);
    console.log("checkMeisiroot通過後GCR",targetSentence,GCR);
    if (targetSentence.length > GCR[GCR.flagsNum].targetIndex)GCR = checkKoutiKeiyousiRoot(targetSentence,GCR);
    console.log("checkKoutiKeiyousiroot通過後GCR",targetSentence,GCR);
    if(truenum == GCR[GCR.flagsNum].wordsCount) GCR.successes[GCR.currentType[GCR.currentTypeNum]].push("true");
    GCR.temporaryWordsNum = GCR[GCR.flagsNum].wordsCount;
    delete GCR[GCR.flagsNum];
    return GCR;
}

function checkKansiRoot(targetSentence,GCR){
    if (Array.isArray(targetSentence[0])) return GCR;
    if (
        targetSentence.length > 0 &&
        (tango[targetSentence[0]].hinsi.includes('冠詞') ||
            tango[targetSentence[0]].tags.includes('所有格') ||
            tango[targetSentence[0]].tags.includes('指示代名詞') ||
            tango[targetSentence[0]].tags.includes('数詞'))
    )   {
        GCR[GCR.flagsNum].wordsCount += 1;
        GCR[GCR.flagsNum].targetIndex += 1;
        GCR[GCR.flagsNum].kansi.push(tango[targetSentence[0]].tags);
    }
    return GCR;
}

function checkZentiKeiyousiRoot(targetSentence,GCR){
    if (Array.isArray(targetSentence[GCR[GCR.flagsNum].targetIndex])){
        let true_M_Num = targetSentence[GCR[GCR.flagsNum].targetIndex].length - 1;
        let keiyousiCount = 0;
        
        if(tango[targetSentence[GCR[GCR.flagsNum].targetIndex][keiyousiCount]].tags.includes('過去分詞') || 
           tango[targetSentence[GCR[GCR.flagsNum].targetIndex][keiyousiCount]].tags.includes('現在分詞')){
            keiyousiCount += 1;
           } else {
            while (keiyousiCount < targetSentence[GCR[GCR.flagsNum].targetIndex].length && 
                    tango[targetSentence[GCR[GCR.flagsNum].targetIndex][keiyousiCount]].hinsi.includes('形容詞')) {
                keiyousiCount++;
            }
           }

        if(true_M_Num != keiyousiCount){
            let keyName = GCR.currentType[GCR.currentTypeNum] + "ZentiKeiyousi"
            GCR.errors[keyName] = errorTemplete;
            GCR.errors[keyName].part = GCR.currentType[GCR.currentTypeNum];
            GCR.errors[keyName].index = currentIndex;
            GCR.errors[keyName].type = "名詞修飾ミス！";
            GCR.errors[keyName].reason = "修飾のやり方が間違っています";
            GCR.errors[keyName].suggestion = "";
        }
        GCR[GCR.flagsNum].wordsCount += true_M_Num;
        GCR[GCR.flagsNum].targetIndex += 1;
    }
    return GCR;
}

function checkMeisi(targetSentence,GCR){
    if (Array.isArray(targetSentence[GCR[GCR.flagsNum].targetIndex])){
        let keyName = GCR.currentType[GCR.currentTypeNum] + "Meisi"
            GCR.errors[keyName] = errorTemplete;
            GCR.errors[keyName].part = GCR.currentType[GCR.currentTypeNum];
            GCR.errors[keyName].index = currentIndex;
            GCR.errors[keyName].type = "名詞ミス！";
            GCR.errors[keyName].reason = "名詞が存在しません";
            GCR.errors[keyName].suggestion = "名詞を入れましょう";
    }
    if(tango[targetSentence[GCR[GCR.flagsNum].targetIndex]].hinsi.includes("名詞")){
        GCR[GCR.flagsNum].wordsCount += 1;
        GCR[GCR.flagsNum].targetIndex += 1;
    } else {
        GCR[GCR.flagsNum].targetIndex += 1;
        let keyName = GCR.currentType[GCR.currentTypeNum] + "Meisi"
            GCR.errors[keyName] = errorTemplete;
            GCR.errors[keyName].part = GCR.currentType[GCR.currentTypeNum];
            GCR.errors[keyName].index = currentIndex;
            GCR.errors[keyName].type = "名詞ミス！";
            GCR.errors[keyName].reason = "名詞が存在しません";
            GCR.errors[keyName].suggestion = "名詞を入れましょう";
    }
    return GCR;
}

function checkKoutiKeiyousiRoot(targetSentence,GCR){
    if (Array.isArray(targetSentence[GCR[GCR.flagsNum].targetIndex])){
        let true_M_Num = targetSentence[GCR[GCR.flagsNum].targetIndex].length - 1;
        let keiyousiCount = 0;

        if(tango[targetSentence[GCR[GCR.flagsNum].targetIndex][keiyousiCount]].hinsi.includes('前置詞')){
            GCR.flagsNum = GCR.flagsNum + 1;
            GCR = checkMeisiRoot(targetSentence,GCR);//仮のGCRを引数にする。本当のGCRは渡さない
            keiyousiCount = GCR.temporaryWordsNum + 1;
            GCR.flagsNum = GCR.flagsNum - 1;
        }

        if(true_M_Num != keiyousiCount){
            let keyName = GCR.currentType[GCR.currentTypeNum] + "KoutiKeiyousi"
            GCR.errors[keyName] = errorTemplete;
            GCR.errors[keyName].part = GCR.currentType[GCR.currentTypeNum];
            GCR.errors[keyName].index = currentIndex;
            GCR.errors[keyName].type = "名詞修飾ミス！";
            GCR.errors[keyName].reason = "後置修飾のやり方が間違っています";
            GCR.errors[keyName].suggestion = "";
        }
        GCR[GCR.flagsNum].wordsCount += true_M_Num;
        GCR[GCR.flagsNum].targetIndex += 1;
    }
    return GCR;
}

function checkDaimeisi(targetSentence,GCR)/*＜代名詞根＞*/{
    let DaimeisiTypeArray;
    let typeText = "";
    switch (GCR.currentType[GCR.currentTypeNum]){
        case "S":
            DaimeisiTypeArray = ['主格', '指示代名詞', '不定代名詞', '疑問代名詞'];
            typeText = "主語";
            break;
        case "C":
            DaimeisiTypeArray = ['主格', '所有代名詞', '再帰代名詞', '指示代名詞', '不定代名詞', '疑問代名詞'];
            typeText = "補語";
            break;
        case "O":
            DaimeisiTypeArray = ['目的格', '再帰代名詞', '指示代名詞', '不定代名詞', '疑問代名詞'];
            typeText = "目的語";
            break;
        default:
            DaimeisiTypeArray = [];
            break;
        }
    if (targetSentence.length = 1 && tango[targetSentence[0]].hinsi.includes('代名詞')) {
        if(DaimeisiTypeArray.some((value) => tango[targetSentence].tags.includes(value))){
            GCR.successes[GCR.currentType[GCR.currentTypeNum]].push("true");
        } else {
            let keyName = GCR.currentType[GCR.currentTypeNum] + "Daimeisi"
            GCR.errors[keyName] = errorTemplete;
            GCR.errors[keyName].part = GCR.currentType[GCR.currentTypeNum];
            GCR.errors[keyName].index = GCR.currentIndex;
            GCR.errors[keyName].type = "代名詞ミス！";
            GCR.errors[keyName].reason = typeText + "に使えない代名詞が入っています";
            GCR.errors[keyName].suggestion = "別の代名詞に変えてみましょう";
            console.log("代名詞エラー：",GCR.errors);
        }
    }
    return GCR;
}